{"version":3,"sources":["../../../../src/server/core/auth/hasPermission.ts"],"names":["hasPermission","user","permission","NotAuthenticatedError","permissions","indexOf"],"mappings":";;;;;;;AAAA;;AAGO,IAAMA,aAAa,GAAG,SAAhBA,aAAgB,CAACC,IAAD,EAA6BC,UAA7B,EAAoD;AAC/E,MAAI,CAACA,UAAL,EAAiB;AACf,WAAO,IAAP;AACD;;AAED,MAAI,CAACD,IAAL,EAAW;AACT,UAAM,IAAIE,wBAAJ,EAAN;AACD;;AAED,SAAOF,IAAI,CAACG,WAAL,IAAoBH,IAAI,CAACG,WAAL,CAAiBC,OAAjB,CAAyBH,UAAzB,MAAyC,CAAC,CAArE;AACD,CAVM","sourcesContent":["import { AuthUser, NotAuthenticatedError } from '@app/core';\nimport _ from 'lodash';\n\nexport const hasPermission = (user: AuthUser | undefined, permission: string) => {\n  if (!permission) {\n    return true;\n  }\n\n  if (!user) {\n    throw new NotAuthenticatedError();\n  }\n\n  return user.permissions && user.permissions.indexOf(permission) !== -1;\n};\n"],"file":"hasPermission.js"}