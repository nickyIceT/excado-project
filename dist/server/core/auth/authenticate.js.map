{"version":3,"sources":["../../../../src/server/core/auth/authenticate.ts"],"names":["authenticate","context","idToken","params","authorization","admin","auth","verifyIdToken","decodedIdToken","authUser","id","uid","roles","permissions"],"mappings":";;;;;;;;;AAAA;;AACA;;;;;;;;AAIO,IAAMA,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA,4BAAG,iBAAOC,OAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAElBC,YAAAA,OAFkB,GAER,qBAAQD,OAAO,CAACE,MAAR,CAAeC,aAAvB,EAAsC,SAAtC,EAAiD,EAAjD,CAFQ;AAAA;AAAA,mBAGKC,uBAAMC,IAAN,GAAaC,aAAb,CAA2BL,OAA3B,CAHL;;AAAA;AAGlBM,YAAAA,cAHkB;AAIlBC,YAAAA,QAJkB,GAIG;AACzBC,cAAAA,EAAE,EAAEF,cAAc,CAACG,GADM;AAEzBC,cAAAA,KAAK,EAAEJ,cAAc,CAACI,KAFG;AAGzBC,cAAAA,WAAW,EAAEL,cAAc,CAACK;AAHH,aAJH;AASxBZ,YAAAA,OAAO,CAACE,MAAR,CAAeM,QAAf,GAA0BA,QAA1B;AATwB;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAZT,YAAY;AAAA;AAAA;AAAA,GAAlB","sourcesContent":["import { replace } from 'lodash';\nimport admin from 'firebase-admin';\nimport { AuthUser } from './AuthUser';\nimport { HookContext } from '@feathersjs/feathers';\n\nexport const authenticate = async (context: HookContext) => {\n  try {\n    const idToken = replace(context.params.authorization, 'Bearer ', '');\n    const decodedIdToken = await admin.auth().verifyIdToken(idToken);\n    const authUser: AuthUser = {\n      id: decodedIdToken.uid,\n      roles: decodedIdToken.roles,\n      permissions: decodedIdToken.permissions,\n    };\n    context.params.authUser = authUser;\n  } catch (err) {\n    //\n  }\n};\n"],"file":"authenticate.js"}