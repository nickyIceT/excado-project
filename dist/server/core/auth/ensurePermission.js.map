{"version":3,"sources":["../../../../src/server/core/auth/ensurePermission.ts"],"names":["ensurePermission","user","permission","NotAuthenticatedError","permissions","indexOf","NotAuthorizedError"],"mappings":";;;;;;;AAAA;;AAGO,IAAMA,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACC,IAAD,EAA6BC,UAA7B,EAAoD;AAClF,MAAIA,UAAJ,EAAgB;AACd,QAAI,CAACD,IAAL,EAAW;AACT,YAAM,IAAIE,wBAAJ,EAAN;AACD,KAFD,MAEO,IAAI,CAACF,IAAI,CAACG,WAAN,IAAqBH,IAAI,CAACG,WAAL,CAAiBC,OAAjB,CAAyBH,UAAzB,MAAyC,CAAC,CAAnE,EAAsE;AAC3E,YAAM,IAAII,qBAAJ,EAAN;AACD;AACF;AACF,CARM","sourcesContent":["import { AuthUser, NotAuthenticatedError, NotAuthorizedError } from '@app/core';\nimport _ from 'lodash';\n\nexport const ensurePermission = (user: AuthUser | undefined, permission: string) => {\n  if (permission) {\n    if (!user) {\n      throw new NotAuthenticatedError();\n    } else if (!user.permissions || user.permissions.indexOf(permission) === -1) {\n      throw new NotAuthorizedError();\n    }\n  }\n};\n"],"file":"ensurePermission.js"}