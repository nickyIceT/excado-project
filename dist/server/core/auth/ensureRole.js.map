{"version":3,"sources":["../../../../src/server/core/auth/ensureRole.ts"],"names":["ensureRole","authUser","roleId","NotAuthenticatedError","roles","indexOf","NotAuthorizedError"],"mappings":";;;;;;;AAAA;;AAGO,IAAMA,UAAU,GAAG,SAAbA,UAAa,CAACC,QAAD,EAAiCC,MAAjC,EAAoD;AAC5E,MAAIA,MAAJ,EAAY;AACV,QAAI,CAACD,QAAL,EAAe;AACb,YAAM,IAAIE,wBAAJ,EAAN;AACD,KAFD,MAEO,IAAI,CAACF,QAAQ,CAACG,KAAV,IAAmBH,QAAQ,CAACG,KAAT,CAAeC,OAAf,CAAuBH,MAAvB,MAAmC,CAAC,CAA3D,EAA8D;AACnE,YAAM,IAAII,qBAAJ,EAAN;AACD;AACF;AACF,CARM","sourcesContent":["import { AuthUser, NotAuthenticatedError, NotAuthorizedError } from '@app/core';\nimport _ from 'lodash';\n\nexport const ensureRole = (authUser: AuthUser | undefined, roleId: string) => {\n  if (roleId) {\n    if (!authUser) {\n      throw new NotAuthenticatedError();\n    } else if (!authUser.roles || authUser.roles.indexOf(roleId) === -1) {\n      throw new NotAuthorizedError();\n    }\n  }\n};\n"],"file":"ensureRole.js"}