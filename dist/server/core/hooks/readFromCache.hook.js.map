{"version":3,"sources":["../../../../src/server/core/hooks/readFromCache.hook.ts"],"names":["readFromCache","context","key","path","method","Object","keys","params","query","map","item","join","getCacheValue","apiCache","get","value","result"],"mappings":";;;;;;;;;AACA;;AACA;;;;;;;;AAEO,IAAMA,aAAa;AAAA;AAAA;AAAA;AAAA;AAAA,4BAAG,iBAAOC,OAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACrBC,YAAAA,GADqB,cACXD,OAAO,CAACE,IADG,cACKF,OAAO,CAACG,MADb,SACsBC,MAAM,CAACC,IAAP,CAAYL,OAAO,CAACM,MAAR,CAAeC,KAAf,GAAuBP,OAAO,CAACM,MAAR,CAAeC,KAAtC,GAA8C,EAA1D,EAA8DC,GAA9D,CAAkE,UAACC,IAAD;AAAA,qBAAUT,OAAO,CAACM,MAAR,CAAeC,KAAf,CAAsBE,IAAtB,CAAV;AAAA,aAAlE,EAAyGC,IAAzG,CAA8G,GAA9G,CADtB;AAErBC,YAAAA,aAFqB,GAEL,qBAAUC,WAASC,GAAnB,CAFK;AAAA;AAAA,mBAGPF,aAAa,CAACV,GAAD,CAHN;;AAAA;AAGrBa,YAAAA,KAHqB;;AAI3B,gBAAIA,KAAJ,EAAW;AACRd,cAAAA,OAAD,CAAiBD,aAAjB,GAAiC,IAAjC;AACAC,cAAAA,OAAO,CAACe,MAAR,GAAiBD,KAAjB;AACD;;AAP0B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAbf,aAAa;AAAA;AAAA;AAAA,GAAnB","sourcesContent":["import { HookContext } from '@feathersjs/feathers';\nimport { promisify } from 'util';\nimport { apiCache } from '..';\n\nexport const readFromCache = async (context: HookContext) => {\n  const key = `/${context.path}/${context.method}${Object.keys(context.params.query ? context.params.query : {}).map((item) => context.params.query![item]).join('&')}`;\n  const getCacheValue = promisify(apiCache.get);\n  const value = await getCacheValue(key);\n  if (value) {\n    (context as any).readFromCache = true;\n    context.result = value;\n  }\n};\n"],"file":"readFromCache.hook.js"}