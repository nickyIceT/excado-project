{"version":3,"sources":["../../../../../../../src/server/modules/machine-news/aggregates/news/hooks/invalidCategoryDetailCache.hook.ts"],"names":["invalidCategoryDetailCache","context","NewsModel","findById","result","id","populate","exec","newsInfo","key","categoryId","slug","apiCache","del","error","logger"],"mappings":";;;;;;;;;AACA;;AACA;;;;;;;;AAEO,IAAMA,0BAA0B;AAAA;AAAA;AAAA;AAAA;AAAA,4BAAG,iBAAOC,OAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACjBC,gBAAUC,QAAV,CAAmBF,OAAO,CAACG,MAAR,CAAeC,EAAf,IAAqBJ,OAAO,CAACI,EAAhD,EAAoDC,QAApD,CAA6D,YAA7D,EAA2EC,IAA3E,EADiB;;AAAA;AAClCC,YAAAA,QADkC;;AAExC,gBAAIA,QAAJ,EAAc;AACNC,cAAAA,GADM,0DACgDD,QAAQ,CAACE,UAAT,CAAoBC,IADpE;;AAEZC,6BAASC,GAAT,CAAaJ,GAAb,EAAkB,UAACK,KAAD,EAAW;AAC3BC,6BAAOD,KAAP,CAAaA,KAAb;AACD,eAFD;AAGD;;AAPuC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAA1Bd,0BAA0B;AAAA;AAAA;AAAA,GAAhC","sourcesContent":["import { HookContext } from '@feathersjs/feathers';\nimport { apiCache, logger } from '@app/core';\nimport { NewsModel } from '../news.repository';\n\nexport const invalidCategoryDetailCache = async (context: HookContext) => {\n  const newsInfo = await NewsModel.findById(context.result.id || context.id).populate('categoryId').exec() as any;\n  if (newsInfo) {\n    const key = `/api/categories/customs/find-category-detail/${newsInfo.categoryId.slug}`;\n    apiCache.del(key, (error) => {\n      logger.error(error);\n    });\n  }\n};\n"],"file":"invalidCategoryDetailCache.hook.js"}