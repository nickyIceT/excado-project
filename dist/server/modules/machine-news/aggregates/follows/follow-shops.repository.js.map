{"version":3,"sources":["../../../../../../src/server/modules/machine-news/aggregates/follows/follow-shops.repository.ts"],"names":["FollowShopSchema","mongoose","Schema","user","type","String","ref","shop","Types","ObjectId","FollowShopModel","model","followShopRepository","findByShop","shopId","find","exec","findOne","query","create","payload","newFollow","save","id","del","deleteOne"],"mappings":";;;;;;;;;AAAA;;AACA;;;;;;;;AAGA,IAAMA,gBAAgB,GAAG,IAAIC,kBAASC,MAAb,CAAoB,8BAAmB;AAC9DC,EAAAA,IAAI,EAAE;AACJC,IAAAA,IAAI,EAAEC,MADF;AAEJC,IAAAA,GAAG,EAAE;AAFD,GADwD;AAK9DC,EAAAA,IAAI,EAAE;AACJH,IAAAA,IAAI,EAAEH,kBAASC,MAAT,CAAgBM,KAAhB,CAAsBC,QADxB;AAEJH,IAAAA,GAAG,EAAE;AAFD;AALwD,CAAnB,CAApB,CAAzB;;AAUA,IAAMI,eAAe,GAAGT,kBAASU,KAAT,CAAe,YAAf,EAA6BX,gBAA7B,CAAxB;;AAEO,IAAMY,oBAA0C,GAAG;AACxDC,EAAAA,UAAU;AAAA;AAAA;AAAA,8BAAE,iBAAOC,MAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACGJ,eAAe,CAACK,IAAhB,CAAqB;AAACR,gBAAAA,IAAI,EAAEO;AAAP,eAArB,EAAqCE,IAArC,EADH;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,KAD8C;AAIxDC,EAAAA,OAAO;AAAA;AAAA;AAAA,8BAAE,kBAAOC,KAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACMR,eAAe,CAACO,OAAhB,CAAwB;AAACd,gBAAAA,IAAI,EAAEe,KAAK,CAACf,IAAb;AAAmBI,gBAAAA,IAAI,EAAEW,KAAK,CAACX;AAA/B,eAAxB,EAA8DS,IAA9D,EADN;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,KAJiD;AAOxDG,EAAAA,MAAM;AAAA;AAAA;AAAA,8BAAE,kBAAOC,OAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACAC,cAAAA,SADA,GACY,IAAIX,eAAJ,CAAoBU,OAApB,CADZ;AAAA;AAAA,qBAEAC,SAAS,CAACC,IAAV,EAFA;;AAAA;AAAA,gDAGCD,SAAS,CAACE,EAHX;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,KAPkD;AAYxDC,EAAAA,GAAG;AAAA;AAAA;AAAA,8BAAE,kBAAOJ,OAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACGV,eAAe,CAACe,SAAhB,CAA0B;AAACtB,gBAAAA,IAAI,EAAEiB,OAAO,CAACjB,IAAf;AAAqBI,gBAAAA,IAAI,EAAEa,OAAO,CAACb;AAAnC,eAA1B,EAAoES,IAApE,EADH;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAZqD,CAAnD","sourcesContent":["import mongoose from 'mongoose';\nimport { addAuditableSchema } from '@app/core';\nimport { FollowShopRepository } from './interfaces/FollowShopRespository';\n\nconst FollowShopSchema = new mongoose.Schema(addAuditableSchema({\n  user: {\n    type: String,\n    ref: 'User',\n  },\n  shop: {\n    type: mongoose.Schema.Types.ObjectId,\n    ref: 'Shop',\n  },\n}));\nconst FollowShopModel = mongoose.model('FollowShop', FollowShopSchema);\n\nexport const followShopRepository: FollowShopRepository = {\n  findByShop: async (shopId: string) => {\n    return await FollowShopModel.find({shop: shopId}).exec() as any;\n  },\n  findOne: async (query) => {\n    return await FollowShopModel.findOne({user: query.user, shop: query.shop}).exec() as any;\n  },\n  create: async (payload) => {\n    const newFollow = new FollowShopModel(payload);\n    await newFollow.save();\n    return newFollow.id;\n  },\n  del: async (payload) => {\n    await FollowShopModel.deleteOne({user: payload.user, shop: payload.shop}).exec();\n  },\n};\n"],"file":"follow-shops.repository.js"}