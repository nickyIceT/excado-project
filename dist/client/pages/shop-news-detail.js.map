{"version":3,"sources":["../../../src/client/pages/shop-news-detail.tsx"],"names":["ShopNewsDetail","props","searchState","dataTotal","dataNewMachine","resultSearchNewestPost","handleFiltersChange","shopInfo","newsInfo","profileState","searchReducers","followState","followReducers","context","req","idToken","jsCookie","get","serviceProxies","cookies","token","newsId","asPath","split","length","Promise","all","findNewsById","searchNewsMostFollow","_id","undefined","searchElasticsearch","newMachine","store","dispatch","searchModel","getDataNewMachineSuccess","res","redirect","config","url","main","Router","push","Component","mapState","rootState","profileModel","followModel","mapDispatch","rootReducer","initStore"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport ShopNewsDetailScreen from '../modules/machine-news/screens/ShopNewsDetailScreen/ShopNewsDetailScreen';\nimport { Shop, News } from '../services/service-proxies';\nimport { NextContext } from 'next';\nimport { getServiceProxy } from '../services';\nimport { Router } from '../routes';\nimport { config } from '../config';\nimport { withRematch, initStore, ProfileState, SelectOption, SearchState, SearchReducers, SearchEffects, FollowState, FollowReducers, FollowEffects, PriceRange } from '../store';\nimport * as jsCookie from 'js-cookie';\n\ninterface Props {\n  shopInfo: Shop;\n  newsInfo: News;\n  profileState: ProfileState;\n  resultSearchNewestPost: { data: any[], before?: string, after?: string };\n  searchState: SearchState;\n  searchReducers: SearchReducers & SearchEffects;\n  followState: FollowState;\n  followReducers: FollowReducers & FollowEffects;\n  handleFiltersChange: (payload: { [key: string]: any }) => void;\n}\ninterface State { }\nclass ShopNewsDetail extends Component<Props, State> {\n  static async getInitialProps(context: NextContext) {\n    let newsInfo: News;\n    let resultSearchNewestPost: any;\n    let newMachine: any;\n    try {\n      let serviceProxies: any;\n      if (!context.req) {\n        const idToken = jsCookie.get('token');\n        serviceProxies = getServiceProxy(idToken);\n      }\n      else {\n        serviceProxies = getServiceProxy((context.req as any).cookies.token);\n      }\n      const newsId = context.asPath.split('/')[context.asPath.split('/').length - 1];\n\n      [newsInfo, resultSearchNewestPost, newMachine] = await Promise.all([\n        serviceProxies.findNewsById(newsId),\n        serviceProxies.searchNewsMostFollow(\n          (context.req as any).shopInfo._id,\n          4,\n          'counterView',\n          '_id',\n          undefined,\n          undefined,\n        ),\n        serviceProxies.searchElasticsearch(\n          undefined,\n          undefined,\n          undefined,\n          undefined,\n          undefined,\n          undefined,\n          undefined,\n          undefined,\n          undefined,\n          undefined,\n          (context.req as any).shopInfo._id,\n          undefined,\n          undefined,\n          undefined,\n          undefined,\n          4,\n          'elasticsearchCreatedAt|desc',\n          undefined,\n          undefined,\n        ),\n      ]);\n\n      (context as any).store.dispatch.searchModel.getDataNewMachineSuccess(newMachine);\n    } catch (error) {\n      if (context.res) {\n        (context.res as any).redirect(`${config.url.main}/not-found`);\n      } else {\n        Router.push(`${config.url.main}/not-found`);\n      }\n    }\n\n    return {\n      shopInfo: (context.req as any).shopInfo,\n      newsInfo,\n      resultSearchNewestPost,\n    };\n  }\n\n  render() {\n    return (\n      <div>\n        <ShopNewsDetailScreen\n          newMachine={this.props.searchState.dataTotal.dataNewMachine}\n          resultSearchNewestPost={this.props.resultSearchNewestPost}\n          handleFiltersChange={this.props.handleFiltersChange}\n          shopInfo={this.props.shopInfo}\n          newsInfo={this.props.newsInfo}\n          profileState={this.props.profileState}\n          searchState={this.props.searchState}\n          searchReducers={this.props.searchReducers}\n          followState={this.props.followState}\n          followReducers={this.props.followReducers}\n        />\n      </div>\n    );\n  }\n}\n\nconst mapState = (rootState: any) => {\n  return {\n    profileState: rootState.profileModel,\n    searchState: rootState.searchModel,\n    followState: rootState.followModel,\n  };\n};\n\nconst mapDispatch = (rootReducer: any) => {\n  return {\n    handleFiltersChange: rootReducer.searchModel.handleFiltersChange,\n    searchReducers: rootReducer.searchModel,\n    followReducers: rootReducer.followModel,\n  };\n};\nexport default withRematch(initStore, mapState, mapDispatch)(ShopNewsDetail);\n"],"file":"shop-news-detail.js"}