{"version":3,"sources":["../../../src/client/pages/my-shop.tsx"],"names":["MyShop","props","weightRanges","categories","brands","shopInfo","searchKeyword","profileState","profileReducers","updateFilters","followReducers","context","authUser","store","getState","profileModel","id","req","res","redirect","Router","push","idToken","cookies","token","serviceProxy","Promise","all","findShopByOwner","getAllWeightRanges","findCategories","findBrands","undefined","data","React","Component","mapState","rootState","searchModel","filters","keyword","mapDispatch","rootReducer","followModel","initStore"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AAGA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAeMA,M;;;;;;;;;;;;;6BAiCM;AACR,aACE,6BAAC,qBAAD;AACE,QAAA,YAAY,EAAE,KAAKC,KAAL,CAAWC,YAD3B;AAEE,QAAA,UAAU,EAAE,KAAKD,KAAL,CAAWE,UAFzB;AAGE,QAAA,MAAM,EAAE,KAAKF,KAAL,CAAWG,MAHrB;AAIE,QAAA,QAAQ,EAAE,KAAKH,KAAL,CAAWI,QAJvB;AAKE,QAAA,aAAa,EAAE,KAAKJ,KAAL,CAAWK,aAL5B;AAME,QAAA,YAAY,EAAE,KAAKL,KAAL,CAAWM,YAN3B;AAOE,QAAA,eAAe,EAAE,KAAKN,KAAL,CAAWO,eAP9B;AAQE,QAAA,aAAa,EAAE,KAAKP,KAAL,CAAWQ,aAR5B;AASE,QAAA,cAAc,EAAE,KAAKR,KAAL,CAAWS;AAT7B,QADF;AAaD;;;;;;iDA9C6BC,O;;;;;;;AACtBC,gBAAAA,Q,GAAYD,OAAD,CAAiBE,KAAjB,CAAuBC,QAAvB,GAAkCC,YAAlC,CAA+CH,Q;;AAChE,oBAAI,CAACA,QAAD,IAAa,CAACA,QAAQ,CAACI,EAA3B,EAA+B;AAC7BL,kBAAAA,OAAO,CAACM,GAAR,GAAeN,OAAO,CAACO,GAAT,CAAqBC,QAArB,CAA8B,YAA9B,CAAd,GAA4DC,gBAAOC,IAAP,cAA5D;AACD;;AAEKC,gBAAAA,O,GAAWX,OAAO,CAACM,GAAT,CAAqBM,OAArB,CAA6BC,K;AACvCC,gBAAAA,Y,GAAe,+BAAgBH,OAAhB,C;;uBACsCI,OAAO,CAACC,GAAR,CAAY,CACrEF,YAAY,CAACG,eAAb,CAA6BhB,QAAQ,CAACI,EAAtC,CADqE,EAErES,YAAY,CAACI,kBAAb,EAFqE,EAGrEJ,YAAY,CAACK,cAAb,EAHqE,EAIrEL,YAAY,CAACM,UAAb,CACEC,SADF,EAEE,EAFF,EAGE,UAHF,EAIEA,SAJF,EAKEA,SALF,CAJqE,CAAZ,C;;;;;AAApD3B,gBAAAA,Q;AAAUH,gBAAAA,Y;AAAcC,gBAAAA,U;AAAYC,gBAAAA,M;;AAa3C,oBAAI,CAACC,QAAL,EAAe;AACbe,kCAAOC,IAAP;AACD;;iDAEO;AACNhB,kBAAAA,QAAQ,EAARA,QADM;AAENH,kBAAAA,YAAY,EAAEA,YAAY,CAAC+B,IAFrB;AAGN9B,kBAAAA,UAAU,EAAEA,UAAU,CAAC8B,IAHjB;AAIN7B,kBAAAA,MAAM,EAAEA,MAAM,CAAC6B;AAJT,iB;;;;;;;;;;;;;;;;;;;EA1BSC,eAAMC,S;;AAkD3B,IAAMC,QAAQ,GAAG,SAAXA,QAAW,CAACC,SAAD,EAAoB;AACnC,SAAO;AACL/B,IAAAA,aAAa,EAAE+B,SAAS,CAACC,WAAV,CAAsBC,OAAtB,CAA8BC,OADxC;AAELjC,IAAAA,YAAY,EAAE8B,SAAS,CAACtB;AAFnB,GAAP;AAID,CALD;;AAOA,IAAM0B,WAAW,GAAG,SAAdA,WAAc,CAACC,WAAD,EAAsB;AACxC,SAAO;AACLjC,IAAAA,aAAa,EAAEiC,WAAW,CAACJ,WAAZ,CAAwB7B,aADlC;AAELD,IAAAA,eAAe,EAAEkC,WAAW,CAAC3B,YAFxB;AAGLL,IAAAA,cAAc,EAAEgC,WAAW,CAACC;AAHvB,GAAP;AAKD,CAND;;eAOe,wBAAYC,gBAAZ,EAAuBR,QAAvB,EAAiCK,WAAjC,EAA8C,0BAAe,SAAf,EAA0BzC,MAA1B,CAA9C,C","sourcesContent":["import React from 'react';\nimport { withRematch, initStore, ProfileState, ProfileEffects, ProfileReducers, PriceRange, SelectOption, FollowEffects, FollowReducers } from '../store';\nimport { withNamespaces } from '../i18n';\nimport MyShopScreen from '../modules/machine-news/screens/MyShopScreen/MyShopScreen';\nimport { Shop, Brand, Category } from '../services/service-proxies';\nimport { NextContext } from 'next';\nimport Router from 'next/router';\nimport { getServiceProxy } from '../services';\n\ninterface Props {\n  weightRanges: PriceRange[];\n  shopInfo: Shop;\n  searchKeyword: string;\n  categories: Category[];\n  brands: Brand[];\n  profileState: ProfileState;\n  profileReducers: ProfileEffects & ProfileReducers;\n  followReducers: FollowEffects & FollowReducers;\n  updateFilters: (payload: {[key: string]: string|number}) => void;\n  handleFiltersChange: (payload: {[key: string]: string|number}) => void;\n}\ninterface State {}\nclass MyShop extends React.Component<Props, State> {\n  static async getInitialProps (context: NextContext) {\n    const authUser = (context as any).store.getState().profileModel.authUser;\n    if (!authUser || !authUser.id) {\n      context.req ? (context.res as any).redirect('/not-found') : Router.push(`/not-found`);\n    }\n\n    const idToken = (context.req as any).cookies.token;\n    const serviceProxy = getServiceProxy(idToken);\n    const [shopInfo, weightRanges, categories, brands] = await Promise.all([\n      serviceProxy.findShopByOwner(authUser.id),\n      serviceProxy.getAllWeightRanges(),\n      serviceProxy.findCategories(),\n      serviceProxy.findBrands(\n        undefined,\n        50,\n        'slug|asc',\n        undefined,\n        undefined,\n      ),\n    ]);\n\n    if (!shopInfo) {\n      Router.push(`/not-found`);\n    }\n\n    return  {\n      shopInfo,\n      weightRanges: weightRanges.data,\n      categories: categories.data,\n      brands: brands.data,\n    };\n  }\n  render () {\n    return (\n      <MyShopScreen\n        weightRanges={this.props.weightRanges}\n        categories={this.props.categories}\n        brands={this.props.brands}\n        shopInfo={this.props.shopInfo}\n        searchKeyword={this.props.searchKeyword}\n        profileState={this.props.profileState}\n        profileReducers={this.props.profileReducers}\n        updateFilters={this.props.updateFilters}\n        followReducers={this.props.followReducers}\n      />\n    );\n  }\n}\n\nconst mapState = (rootState: any) => {\n  return {\n    searchKeyword: rootState.searchModel.filters.keyword,\n    profileState: rootState.profileModel,\n  };\n};\n\nconst mapDispatch = (rootReducer: any) => {\n  return {\n    updateFilters: rootReducer.searchModel.updateFilters,\n    profileReducers: rootReducer.profileModel,\n    followReducers: rootReducer.followModel,\n  };\n};\nexport default withRematch(initStore, mapState, mapDispatch)(withNamespaces('my-shop')(MyShop));\n"],"file":"my-shop.js"}