{"version":3,"sources":["../../../src/client/pages/search-details.tsx"],"names":["SearchDetailsPage","props","topBrands","sortBy","searchData","loading","searchFilters","brand","category","model","location","state","newsType","minPrice","maxPrice","weightRange","keyword","brands","provinces","categories","weightRanges","profileState","profileReducers","getNextPage","getPrevPage","hasPrev","hasNext","followState","followReducers","searchReducers","context","query","queryString","parse","asPath","split","req","idToken","jsCookie","get","serviceProxy","cookies","token","Promise","all","findTopBrands","findBrands","undefined","findCategories","getAllWeightRanges","findProvinces","filters","data","store","dispatch","searchModel","updateFilters","searchState","getState","searchElasticsearch","priceType","owner","shop","type","result","getDataSuccess","namespacesRequired","Component","mapState","rootState","after","before","effects","profileModel","followModel","mapDispatch","rootReducer","initStore"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { SearchDetailsScreen } from '../modules/machine-news/screens/SearchDetailsScreen/SearchDetailsScreen';\nimport { Brand, Category, News, Province, WeightRange } from '../services/service-proxies';\nimport {\n  withRematch, initStore, ProfileState, ProfileEffects, ProfileReducers,\n  SearchFilters, FollowState, FollowReducers, FollowEffects, SearchReducers, SearchEffects,\n} from '../store';\nimport { getServiceProxy } from '../services';\nimport { NextContext } from 'next';\nimport queryString from 'query-string';\nimport { generateFilters } from '../core';\nimport { withNamespaces } from '../i18n';\nimport * as jsCookie from 'js-cookie';\n\ninterface Props {\n  loading: {\n    handleSortChange: boolean;\n    handleFiltersChange: boolean;\n    getNextPage: boolean;\n    getPrevPage: boolean;\n  };\n  sortBy: string;\n  hasPrev: boolean;\n  hasNext: boolean;\n  searchData: News[];\n  searchFilters: SearchFilters;\n  brands: Brand[];\n  topBrands: Brand[];\n  categories: Category[];\n  provinces: Province[];\n  weightRanges: WeightRange[];\n  profileState: ProfileState;\n  profileReducers: ProfileReducers & ProfileEffects;\n  followState: FollowState;\n  followReducers: FollowReducers & FollowEffects;\n  searchReducers: SearchReducers & SearchEffects;\n  getNextPage: () => void;\n  getPrevPage: () => void;\n}\n\ninterface State { }\n\nclass SearchDetailsPage extends Component<Props, State> {\n  static async getInitialProps(context: NextContext) {\n    const query = queryString.parse(context.asPath.split('?')[1]);\n    let serviceProxy: any;\n    if (!context.req) {\n      const idToken = jsCookie.get('token');\n      serviceProxy = getServiceProxy(idToken);\n    }\n    else {\n      serviceProxy = getServiceProxy((context.req as any).cookies.token);\n    }\n    const [topBrands, brands, categories, weightRanges, provinces] = await Promise.all([\n      serviceProxy.findTopBrands(),\n      serviceProxy.findBrands(\n        query.brand as any,\n        30,\n        'slug|asc',\n        undefined,\n        undefined,\n      ),\n      serviceProxy.findCategories(),\n      serviceProxy.getAllWeightRanges(),\n      serviceProxy.findProvinces(),\n    ]);\n\n    const filters = generateFilters(query, {\n      brands: brands.data,\n      categories: categories.data,\n      weightRanges: weightRanges.data,\n      provinces: provinces.data,\n    });\n    (context as any).store.dispatch.searchModel.updateFilters(filters);\n\n    const searchState = (context as any).store.getState().searchModel;\n    const result = await serviceProxy.searchElasticsearch(\n      searchState.filters.keyword,\n      searchState.filters.state,\n      searchState.filters.priceType,\n      searchState.filters.minPrice,\n      searchState.filters.maxPrice,\n      searchState.filters.weightRange,\n      undefined,\n      searchState.filters.newsType,\n      searchState.filters.category,\n      searchState.filters.owner,\n      searchState.filters.shop,\n      searchState.filters.location,\n      searchState.filters.type,\n      searchState.filters.brand,\n      searchState.filters.model,\n      16,\n      searchState.sortBy,\n      undefined,\n      undefined,\n    );\n\n    (context as any).store.dispatch.searchModel.getDataSuccess(result);\n    return {\n      namespacesRequired: ['common', 'search-detail'],\n      topBrands: topBrands.data,\n      brands: brands.data,\n      categories: categories.data,\n      weightRanges: weightRanges.data,\n      provinces: provinces.data,\n    };\n  }\n\n  render() {\n    return (\n      <div>\n        <SearchDetailsScreen\n          topBrands={this.props.topBrands}\n          sortBy={this.props.sortBy}\n          data={this.props.searchData}\n          loading={this.props.loading}\n          selectedBrand={this.props.searchFilters.brand}\n          selectedCategory={this.props.searchFilters.category}\n          selectedModel={this.props.searchFilters.model}\n          selectedProvince={this.props.searchFilters.location}\n          selectedState={this.props.searchFilters.state}\n          selectedNewsType={this.props.searchFilters.newsType}\n          minPrice={this.props.searchFilters.minPrice}\n          maxPrice={this.props.searchFilters.maxPrice}\n          selectedWeightRange={this.props.searchFilters.weightRange}\n          searchKeyword={this.props.searchFilters.keyword}\n          brands={this.props.brands}\n          provinces={this.props.provinces}\n          categories={this.props.categories}\n          weightRanges={this.props.weightRanges}\n          profileState={this.props.profileState}\n          profileReducers={this.props.profileReducers}\n          getNextPage={this.props.getNextPage}\n          getPrevPage={this.props.getPrevPage}\n          hasPrev={this.props.hasPrev}\n          hasNext={this.props.hasNext}\n          followState={this.props.followState}\n          followReducers={this.props.followReducers}\n          searchReducers={this.props.searchReducers}\n        />\n      </div>\n    );\n  }\n}\n\nconst mapState = (rootState: any) => {\n  return {\n    hasNext: rootState.searchModel.after ? true : false,\n    hasPrev: rootState.searchModel.before ? true : false,\n    searchData: rootState.searchModel.data,\n    loading: rootState.loading.effects.searchModel,\n    profileState: rootState.profileModel,\n    searchFilters: rootState.searchModel.filters,\n    followState: rootState.followModel,\n    sortBy: rootState.searchModel.sortBy,\n  };\n};\n\nconst mapDispatch = (rootReducer: any) => {\n  return {\n    profileReducers: rootReducer.profileModel,\n    getNextPage: rootReducer.searchModel.getNextPage,\n    getPrevPage: rootReducer.searchModel.getPrevPage,\n    followReducers: rootReducer.followModel,\n    searchReducers: rootReducer.searchModel,\n  };\n};\n\nexport default withRematch(initStore, mapState, mapDispatch)(withNamespaces('search-detail')(SearchDetailsPage));\n"],"file":"search-details.js"}