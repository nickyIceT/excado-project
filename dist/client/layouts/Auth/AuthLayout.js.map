{"version":3,"sources":["../../../../src/client/layouts/Auth/AuthLayout.tsx"],"names":["AuthLayout","props","setState","clientOnly","signInFlow","signInOptions","firebase","auth","GoogleAuthProvider","PROVIDER_ID","FacebookAuthProvider","callbacks","signInSuccessWithAuthResult","_authResult","_redirectUrl","currentUser","getIdToken","idToken","form","document","getElementById","input","createElement","type","name","value","appendChild","submit","signInFailure","error","console","log","state","children","uiConfig","pageName","display","React","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './AuthLayout.less';\nimport { Divider } from 'antd';\nimport StyledFirebaseAuth from 'react-firebaseui/StyledFirebaseAuth';\nimport firebase from 'firebase/app';\nimport 'firebase/auth';\nimport { Link } from '../../routes';\n\ninterface Props {\n  pageName: 'login' | 'register';\n}\ninterface State {\n  clientOnly: boolean;\n}\nexport class AuthLayout extends React.Component<Props, State> {\n  constructor(props: any) {\n    super(props);\n    this.state = {\n      clientOnly: false,\n    };\n  }\n\n  componentDidMount = () => {\n    this.setState({\n      clientOnly: true,\n    });\n  }\n\n  uiConfig = {\n    signInFlow: 'popup',\n    signInOptions: [\n      firebase.auth.GoogleAuthProvider.PROVIDER_ID,\n      firebase.auth.FacebookAuthProvider.PROVIDER_ID,\n    ],\n    callbacks: {\n      signInSuccessWithAuthResult: (\n        _authResult: any,\n        _redirectUrl?: string,\n      ) => {\n        (async () => {\n          const idToken = await firebase.auth().currentUser!.getIdToken();\n\n          const form = document.getElementById('form');\n          const input = document.createElement('input');\n          input.type = 'text';\n          input.name = 'token';\n          input.value = idToken;\n          form!.appendChild(input);\n          (form as any).submit();\n        })();\n        return false;\n      },\n      signInFailure: async (error: any) => {\n        // tslint:disable-next-line:no-console\n        console.log(error);\n      },\n    },\n  };\n\n  render() {\n    return (\n      <div className='auth-container'>\n        <div className='form-wrapper'>\n          <div className='logo'>\n            <span>Techkids Software</span>\n          </div>\n\n          {this.props.children}\n\n          <Divider dashed={true} />\n\n          {this.state.clientOnly && <StyledFirebaseAuth uiConfig={this.uiConfig} firebaseAuth={firebase.auth()} className='oauth-container' />}\n\n          <div className='links-wrapper'>\n            <a href='#' className='forgot'>Forgot password</a>\n            {this.props.pageName === 'login' && (\n              <Link route='/dang-ki'>\n                <a className='login-register'>Create an account</a>\n              </Link>\n            )}\n            {this.props.pageName === 'register' && (\n              <Link route='/dang-nhap'>\n                <a className='login-register'>Already have an account? Log in</a>\n              </Link>\n            )}\n            <form id='form' method='post' action='/auth/login' style={{display: 'none'}} />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n"],"file":"AuthLayout.js"}